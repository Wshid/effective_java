## [ITEM.72] 표준 예외 사용

### 표준 예외 재사용의 이점
- 작성한 API가 다른 사람이 익히고 사용하기 쉬워짐
  - 많은 프오르개럼에게 익숙한 규약을 그대로 따르기 때문
- 작성한 API를 사용한 프로그램도
  - 낯선 예외를 사용하지 않게 되어
  - 읽기 쉬움
- **예외 클래스의 수**가 적을 수록
  - **메모리 사용량** 저하
  - **클래스 적재 시간 감소**

### IllegalArgumentException
- 가장 많이 사용되는 예외(ITEM.49)
- 호출자가 **인수**로 **부적절한 값**을 넘길 때 던지는 예외
  - 반복 횟수를 음수로 넘기는 등

### IllegalStateException
- 자주 재사용되는 예외
- 대상 객체의 **상태**가
  - 호출된 메서드를 수행하기에 **적합하지 않을 때** 발생
    - 초기화 되지 않은 객체를 사용하려 할때 등

### 메서드가 던지는 예외의 구분
- 메서드가 던지는 모든 예외를 **잘못된 인수**나 **상태**라고 정의할수도 있겠으나,
  - 그 중 특수한 일부는 따로 **구분하여 사용**
- `null`값을 허용하지 않는 메서드에
  - `null`을 전달했을 경우,
    - 관례상 `IllegalArgumentException`이 아닌 `NullPointerException`을 던진다
- 어떤 시퀀스의 허용 범위를 넘는 값을 건넬 때도
  - `IllegalArgumentException`이 아닌 `IndexOutOfBoundsException`을 사용

### ConcurrentModificationException
- 단일 스레드에서 사용하려고 설계한 객체를
  - **여러 스레드**가 동시에 수정하려 할 때 발생
- **외부 동기화**방식으로 사용하려고 설계한 객체도 마찬가지
- 사실 **동시 수정**을 확실히 검출할 수 있는 안정된 방법은 없으나,
  - 이 예외는 문제가 생길 **가능성**을 알려주는 정도의 역할로 쓰임

### UnsupportedOperationException
- 클라이언트가 요청한 동ㅈ가을 **대상 객체**가 **지원하지 않을 때** 발생
- 대부분 객체는 **자신이 정의한 메서드**를 모두 지원하니,
  - 흔히 사용되는 예외는 아님
- 보통은 구현하려는 **인터페이스**의 메서드 일부를 구현할 수 없을 때 사용 됨
  - 예컨데, 원소를 넣을 수만 있는 `List` 구현체에 대고
  - 누군가 `remove` 메서드를 호출하면 이 예외가 발생함

### 직접 재사용 불가
- `Exception`, `RuntimeException`, `Throwable`, `Error`의 경우
  - **직접 재사용하지 말 것**
- 이 클래스들은 단순 **추상 클래스**라고 생각하기
- 이 예외들은, 타 예외들의 **상위 클래스**이므로,
  - 여러 성격의 예외들을 **포괄하는 클래스**
  - 안정적으로 테스트할 수 없음

### 다른 상황에서의 다른 예외 사용
- **복소수**나 **유리수**를 다루는 객체를 작성할 때
  - `ArithmeticException`이나 `NumberFormatException`을 재사용할 수 있음
- 상황에 부적합하다면, 항상 **표준 예외**를 재사용할 것
- 이 때, `API 문서`를 참고해
  - 그 예외가 어떤 상황에서 던져지는지 꼭 확인해야 함
- **예외의 이름**뿐 아니라
  - **예외가 던져지는 맥락**도 부합할 때 재사용해야 함
- 더 많은 정보를 제공하려면 **표준 예외를 확장**해도 좋음
- 단, 예외는 **직렬화**할 수 있음
  - 직렬화에는 많은 부담이 따름
- 이 사실만으로도,
  - 나만의 예외를 새로 만들지 않아야할 근거로 활용할 수 있음

### 재사용할 예외 선택이 어려울 경우
- 위에서 설명한 주로 사용되는 예외가 **상호 베타적**이지 않음
  - 그에 따라 선택이 어려울 수 있음
- 예시
  - 카드 덱을 표현하는 객체
  - 인수로 건넨 수만큼의 카드를 뽑아 나눠주는 메서드
  - 덱에 남아 있는 카드 수보다, 큰 값을 건넨다면?
  - 인수의 값이 너무 크다고 본다면
    - `IllegalArgumentException`
  - 덱에 남은 카드의 수가 너무 적다면
    - `IllegalStateException`
- 통상적인 규칙
  - 인수 값이 무엇이었던
  - **어차피 실패**했을거라면, `IllegalStateException`
    - 그렇지 않을 경우, `IllegalArgumentException`